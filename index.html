<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2026 新春尋寶拼字趣</title>

<style>
:root {
    --primary-red: #d32f2f;
    --line-color: #eeeeee;
    --text-dark: #1a1a1a;
    --text-light: #999;
}

body {
    font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
    background-color: #ffffff;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding: 40px 0;
}

header { text-align: center; margin-bottom: 25px; width: 85%; }
h1 { font-size: 1.6rem; margin: 0; letter-spacing: 4px; }
.en-title { font-size: 0.75rem; color: var(--text-light); letter-spacing: 2px; margin-top: 5px; }
.guide-text { font-size: 0.9rem; color: #666; margin-top: 15px; }

.grid-container {
    display: grid;
    width: 85vw;
    max-width: 450px;
    margin: 20px 0;
    border-right: 0.5px solid var(--line-color);
    border-bottom: 0.5px solid var(--line-color);
}

.cell {
    aspect-ratio: 1 / 1;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    user-select: none;
    border-left: 0.5px solid var(--line-color);
    border-top: 0.5px solid var(--line-color);
    transition: background-color 0.2s;
}

.cell.selected {
    background-color: var(--primary-red);
    color: #fff;
}

.footer-ui {
    width: 85%;
    max-width: 450px;
    text-align: center;
}

#selectedChars {
    font-size: 1.6rem;
    height: 40px;
    color: var(--primary-red);
    letter-spacing: 6px;
}

#status-msg {
    height: 20px;
    margin-bottom: 20px;
    font-size: 0.85rem;
}

.submit-btn {
    background: var(--text-dark);
    color: #fff;
    border: none;
    width: 180px;
    padding: 12px 0;
    font-size: 1rem;
    letter-spacing: 5px;
    cursor: pointer;
}

.mode-switcher {
    display: flex;
    justify-content: space-around;
    margin-top: 30px;
}

.mode-btn {
    background: none;
    border: none;
    color: var(--text-light);
    font-size: 0.75rem;
    cursor: pointer;
}

.mode-btn.active {
    color: var(--text-dark);
    font-weight: 600;
    border-bottom: 2px solid var(--text-dark);
}
</style>
</head>

<body>

<header>
    <h1>2026 新春尋寶拼字趣</h1>
    <div class="en-title">Lunar New Year Word Search 2026</div>
    <p class="guide-text">選取第一眼看到的關鍵詞</p>
</header>

<div id="grid" class="grid-container"></div>

<div class="footer-ui">
    <div id="selectedChars"></div>
    <div id="status-msg"></div>
    <button class="submit-btn" onclick="checkAnswer()">提交</button>

    <div class="mode-switcher">
        <button class="mode-btn" id="btn6-6" onclick="changeMode(6,6)">6×6</button>
        <button class="mode-btn" id="btn6-8" onclick="changeMode(6,8)">6×8</button>
        <button class="mode-btn active" id="btn8-8" onclick="changeMode(8,8)">8×8</button>
        <button class="mode-btn" id="btn10-10" onclick="changeMode(10,10)">10×10</button>
    </div>

    <div class="mode-switcher">
        <button class="mode-btn active" id="btn-lang-zh" onclick="switchLang('zh')">中文</button>
        <button class="mode-btn" id="btn-lang-en" onclick="switchLang('en')">EN</button>
    </div>
</div>

<script>
/* ===== 語言資料 ===== */
let currentLang = 'zh';

const wordMap = {
    zh: [
        "平安健康","財源廣進","萬事如意","心想事成",
        "大吉大利","步步高升","招財進寶","金玉滿堂",
        "龍馬精神","福氣滿門"
    ],
    en: [
        "HEALTH","WEALTH","HAPPINESS","SUCCESS","LUCK","PROSPERITY"
    ]
};

const fillerMap = {
    zh: "喜樂春福吉祥富貴安康順利發財年慶餘",
    en: "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
};

/* ===== Word Search 核心 ===== */
const directions = [
    {x:1,y:0}, {x:0,y:1}, {x:1,y:1}
];

function createEmptyGrid(cols, rows) {
    return Array.from({length: rows}, () => Array(cols).fill(''));
}

function canPlaceWord(grid, word, sx, sy, dir, cols, rows) {
    for (let i=0;i<word.length;i++) {
        const x = sx + dir.x*i;
        const y = sy + dir.y*i;
        if (x<0||x>=cols||y<0||y>=rows) return false;
        if (grid[y][x] !== '' && grid[y][x] !== word[i]) return false;
    }
    return true;
}

function placeWord(grid, word, cols, rows) {
    for (let i=0;i<100;i++) {
        const dir = directions[Math.floor(Math.random()*directions.length)];
        const sx = Math.floor(Math.random()*cols);
        const sy = Math.floor(Math.random()*rows);
        if (canPlaceWord(grid, word, sx, sy, dir, cols, rows)) {
            for (let j=0;j<word.length;j++) {
                grid[sy+dir.y*j][sx+dir.x*j] = word[j];
            }
            return;
        }
    }
}

function buildWordSearch(cols, rows) {
    const grid = createEmptyGrid(cols, rows);
    const words = [...wordMap[currentLang]].sort(()=>Math.random()-0.5)
        .slice(0, cols>=10 ? 6 : 4);

    words.forEach(w => placeWord(grid, w, cols, rows));

    const filler = fillerMap[currentLang];
    for (let y=0;y<rows;y++)
        for (let x=0;x<cols;x++)
            if (!grid[y][x])
                grid[y][x] = filler[Math.floor(Math.random()*filler.length)];

    return grid.flat();
}

/* ===== UI ===== */
let selectedChars = [];
let currentCols = 8;
let currentRows = 8;

function initGame(cols, rows) {
    currentCols = cols;
    currentRows = rows;
    selectedChars = [];
    document.getElementById('grid').innerHTML = '';
    document.getElementById('grid').style.gridTemplateColumns = `repeat(${cols},1fr)`;

    let fontSize = cols===6?"8vw":cols===8?"5.5vw":"4.5vw";
    let maxFont = cols===6?"32px":cols===8?"22px":"18px";

    const data = buildWordSearch(cols, rows);
    data.forEach(char=>{
        const c=document.createElement('div');
        c.className='cell';
        c.textContent=char;
        c.style.fontSize=window.innerWidth>450?maxFont:fontSize;
        c.onclick=()=>{
            c.classList.toggle('selected');
            c.classList.contains('selected')?
                selectedChars.push(char):
                selectedChars.splice(selectedChars.indexOf(char),1);
            document.getElementById('selectedChars').textContent=selectedChars.join('');
        };
        document.getElementById('grid').appendChild(c);
    });
}

function checkAnswer() {
    const str = selectedChars.join('');
    const msg = document.getElementById('status-msg');
    if (wordMap[currentLang].includes(str)) {
        msg.textContent = "✦ 找到祝福了 ✦";
        msg.style.color = "var(--primary-red)";
    } else {
        msg.textContent = "再試試看";
        msg.style.color = "#ccc";
    }
}

function changeMode(c,r){
    document.querySelectorAll('.mode-btn').forEach(b=>b.classList.remove('active'));
    document.getElementById(`btn${c}-${r}`).classList.add('active');
    initGame(c,r);
}

function switchLang(lang){
    currentLang = lang;
    document.getElementById('btn-lang-zh').classList.toggle('active',lang==='zh');
    document.getElementById('btn-lang-en').classList.toggle('active',lang==='en');
    initGame(currentCols,currentRows);
}

/* ===== Start ===== */
initGame(8,8);
</script>

</body>
</html>
